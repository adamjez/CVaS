"use strict";function AlgorithmClient(n,t){var i=this;this.algorithmEndpoint=n;this.createRequestBodyCallback=t;zip.workerScriptsPath="/lib/zipjs/WebContent/";var f=function(n,t,i){$("#body-request-message").html("<p>"+n+" "+t+"<\/p><p>BODY: "+i+"<\/p>");$("#request-message").show();$("#request-message").alert();$("#request-message").delay(5e3).slideUp(500,0)},r=function(n,t){$.ajax({type:"GET",url:"/runs/"+n,timeout:0,headers:{accept:"application/json"},success:function(n){u(n.id,n.status,n.duration,n.stdOut,n.stdErr,n.zip,t)}})},e=function(n,t){var i=document.createElement("button"),u,f;i.innerHTML="Check Again (Checking again automatically)";t.append('<div class="progress"><div class="progress-bar" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100"><\/div ><\/div >');u=6;f=setInterval(function(){if(u<=0)clearInterval(f),r(n,t);else{var i=100- --u*20;t.find(".progress-bar").css("width",i+"%").attr("aria-valuenow",i)}},1e3);i.onclick=function(){return clearInterval(f),r(n,t),!1};t.append(i)},u=function(n,t,i,r,u,f,o){if(o.html(""),o.append("<p>Id: "+n+"<\/p>"),o.append("<p>Status: "+t+"<\/p>"),i!==undefined&&o.append("<p>Duration: "+(i/1e3).toFixed(2)+" s<\/p>"),t==="notFinished"){e(n,o);return}(r!==undefined&&r.trim()!==""&&o.append("<p>StdOut: "+r+"<\/p>"),u!==undefined&&u.trim()!==""&&o.append("<p>StdErr: "+u+"<\/p>"),f!==undefined)&&(o.append('<p>Zip: <a href= "'+f+'">Download<\/a><\/p>'),zip.createReader(new zip.HttpReader(f),function(n){n.getEntries(function(t){t.forEach(function(t){t.getData(new zip.BlobWriter("application/octet-stream"),function(t){n.close();o.prepend('<a class="result-preview" href="#"><img class="result-preview" src="'+URL.createObjectURL(t)+'"/><\/a>');o.find("a.result-preview").click(function(n){return $.featherlight('<img src="'+URL.createObjectURL(t)+'"/>'),n.preventDefault(),!1})})})})},onerror))},o=function(n,t,r){var s=$("li[qq-file-id='"+r+"']"),e=s.find(".loader"),h=s.find("div.result"),c,o;e.show();c=i.createRequestBodyCallback(t);o=JSON.stringify(c);f("POST",i.algorithmEndpoint,o);$.ajax({type:"POST",url:i.algorithmEndpoint,data:o,timeout:0,headers:{accept:"application/json"},contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){e.hide();u(n.runId,n.status,n.duration,n.stdOut,n.stdErr,n.zip,h)},complete:function(){e.hide()},error:function(){h.append("<p><b>Something bad happened. Contact admin, please<\/b><\/p>")}})};$("#fine-uploader-gallery").fineUploader({template:"qq-template-gallery",request:{endpoint:"/files"},deleteFile:{enabled:!1,endpoint:"/files"},thumbnails:{placeholders:{waitingPath:"/lib/fine-uploader/dist/placeholders/waiting-generic.png",notAvailablePath:"/lib/fine-uploader/dist/placeholders/not_available-generic.png"}},validation:{allowedExtensions:["jpeg","jpg","gif","png","bmp"]},callbacks:{onComplete:function(n,t,i){i.ids.forEach(function(i){o(t,i,n)})}}})}